#!/bin/bash

. pk-common

pk-create-local-dirs

pushd libs >/dev/null

# find all files in root
tmp_files=`pk-make-tmp`
find . -type f > "$tmp_files"

# remove files from installed packages
popd >/dev/null
cd list
tmp_set=`pk-make-tmp`
ls | while read file
do
  # set complement - files int $tmp_files that are not in $file
  comm -23 <(sort "$tmp_files") <(sort "$file") > "$tmp_set"
  cp "$tmp_set" "$tmp_files"
done

if [ -s "$tmp_files" ]
then
  cat "$tmp_files"
else
  echo "No new files" >&2
fi
